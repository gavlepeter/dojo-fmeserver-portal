/*
dojo-fmeserver-portal
https://github.com/gavlepeter/dojo-fmeserver-portal
@version 1.1.0
@author Peter JÃ¤derkvist <p.jaderkvist@gmail.com>
@module FMEPortal
@license See https://github.com/gavlepeter/dojo-fmeserver-portal/blob/master/License.md
 */
require({cache:{"app/FMEPortal/RestManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/request/xhr ./RestManager/v2RestCalls ./RestManager/v3RestCalls".split(" "),function(l,c,f,a,b,g,d){return l("FmePortal-RestManager",[g,d],{isInitialized:!1,constructor:function(a){this.options=c.mixin(this.options,a);this.restVersion=this.options.settings.fme.server.version;this.sessionId=Number(new Date);this._setupAPIMethods()},init:function(a){a.server&&a.token&&
(this.token=a.token,this.serverUrl=a.server,this.restUrl=a.server+"/fmerest/"+this.restVersion,this.isInitialized=!0)},_setupAPIMethods:function(){f.forEach("generateToken dataUpload runWorkspaceWithData runDataDownload runDataStreaming runJobSubmitter submitJob submitSyncJob getRepositories getResources getSession getInfo getWorkspacesForRepository getWorkspaceParameters getWorkspaceInfo getRunningJobs getQueuedJobs".split(" "),c.hitch(this,function(b){this[b]=function(){var c="_"+this.restVersion+
"_"+b;if("function"===typeof this[c])return this[c].apply(this,arguments);c=new a;c.resolve({error:b+" is not implemented for API version "+this.restVersion});return c}}))},_ajax:function(c,d,f,g,m){var k=new a,h=null,p=null;f&&f.get&&f.get("files[]")||f&&f.append?h=f:f&&f.publishedParameters?h=JSON.stringify(f):p=f;"v2"===this.restVersion&&(c+=-1!==c.indexOf("?")?"\x26detail\x3dhigh":"?detail\x3dhigh");var q;b(c,{method:d||"GET",query:p,data:h,headers:{Accept:m||"application/json","Content-Type":g||
null,Authorization:"fmetoken token\x3d"+this.token}}).then(function(a){var b;try{b=JSON.parse(a)}catch(C){}k.resolve({success:!0,data:b||a,responseType:q})},function(a){var b;try{b=JSON.parse(a.response.data)}catch(C){}k.resolve({success:!1,data:b||a})},function(a){q=a.getHeader("Content-Type")});return k}})})},"app/FMEPortal/RestManager/v2RestCalls":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(l,c,f){return l(null,{constructor:function(){},_v2_runWorkspaceWithData:function(a,
b,g,d){var k=new f;a=this.serverUrl+"/"+d.service+"/"+a+"/"+b+"?";b=d.params;var h="";for(i=0;i<d.paramnames.length;i++){var h=h+(d.paramnames[i]+"\x3d"+encodeURI('"')),p;for(p in d.files[i])h+=encodeURI('"'+g[i]+"/"+d.files[i][p].name+'"'),d.files[i].length-1>Number(p)&&(h+=encodeURI(" "));h+=encodeURI('"');h+="\x26"}h+=this._toParameterString({opt_responseformat:"json",token:this.token})+"\x26"+(b||"");this._ajax(a+h).then(c.hitch(this,function(a){k.resolve(a)}));return k},_v2_runDataDownload:function(a,
b,g){var d=new f;a=this.serverUrl+"/fmedatadownload/"+a+"/"+b;g=this._toParameterString({opt_responseformat:"json",opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v2_runDataStreaming:function(a,b,g){var d=new f;a=this.serverUrl+"/fmedatastreaming/"+a+"/"+b;g=this._toParameterString({opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,
function(a,b){d.resolve(a)}));return d},_v2_runJobSubmitter:function(a,b,g){var d=new f;a=this.serverUrl+"/fmejobsubmitter/"+a+"/"+b;g=this._toParameterString({opt_responseformat:"json",opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v2_submitJob:function(a,b,g){var d=new f;this._ajax(this.restUrl+"/transformations/commands/submit/"+a+"/"+b,"POST",g,"application/json").then(c.hitch(this,
function(a){d.resolve(a)}));return d},_v2_submitSyncJob:function(a,b,g){var d=new f;this._ajax(this.restUrl+"/transformations/commands/transact/"+a+"/"+b,"POST",g,"application/json").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v2_generateToken:function(a,b,g,d){var k=new f,h=this.serverUrl+"/fmetoken/service/generate";a=this._toParameterString({user:a,password:b,expiration:g,timeunit:d});this._ajax(h,"POST",a,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){a.success?
k.resolve(a.data):k.resolve(a)}));return k},_v2_getRepositories:function(){var a=new f;this._ajax(this.restUrl+"/repositories").then(c.hitch(this,function(b){b.success?a.resolve({items:b.data}):a.resolve(b)}));return a},_v2_getResources:function(){var a=new f;this._ajax(this.restUrl+"/resources").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v2_getWorkspacesForRepository:function(a){var b=new f;this._ajax(this.restUrl+"/repositories/"+a+"/items").then(c.hitch(this,
function(a){a.success?b.resolve({items:a.data}):b.resolve(a)}));return b},_v2_getWorkspaceParameters:function(a,b){var g=new f;this._ajax(this.restUrl+"/repositories/"+a+"/items/"+b+"/parameters").then(c.hitch(this,function(a){a.success?g.resolve(a.data):g.resolve(a)}));return g},_v2_getWorkspaceInfo:function(a,b){var g=new f;this._ajax(this.restUrl+"/repositories/"+a+"/items/"+b).then(c.hitch(this,function(a){a.success?g.resolve(a.data):g.resolve(a)}));return g},_v2_getSession:function(a,b,g){var d=
new f;a=this.serverUrl+"/fmedataupload/"+a+"/"+b;b={opt_extractarchive:!1,opt_pathlevel:3,opt_fullpath:!0,token:this.token};g&&(b.opt_namespace=g);g=this._toParameterString(b);this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){a.success?d.resolve(a.data):d.resolve(a)}));return d},_v2_dataUpload:function(a,b,g,d){var k=new f;d=d||null;a=this.serverUrl+"/fmedataupload/"+a+"/"+b;null!==d&&(a+=";jsessionid\x3d"+d);b={opt_extractarchive:!0,opt_pathlevel:3,
opt_fullpath:!0};d&&(b.opt_namespace=d);a+="?"+this._toParameterString(b);d=new FormData;for(b=0;b<g.files.length;b++)d.append("files[]",g.files[b]);d.append("token",this.token);this._ajax(a,"POST",d).then(c.hitch(this,function(a){a.success?k.resolve(a.data):k.resolve(a)}));return k},_v2_getRunningJobs:function(){var a=new f;this._ajax(this.restUrl+"/transformations/jobs/running").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v2_getQueuedJobs:function(){var a=
new f;this._ajax(this.restUrl+"/transformations/jobs/queued").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v2_getInfo:function(){var a=new f;this._ajax(this.restUrl+"/info").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_toParameterString:function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&(b+=c+"\x3d"+a[c]+"\x26");return-1!==b.indexOf("\x26")?b.slice(0,-1):b}})})},"app/FMEPortal/RestManager/v3RestCalls":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/Deferred"],function(l,c,f){return l(null,{constructor:function(){},_v3_runWorkspaceWithData:function(a,b,g,d){var k=new f;a=this.serverUrl+"/"+d.service+"/"+a+"/"+b+"?";b=d.params;var h="";for(i=0;i<d.paramnames.length;i++){var h=h+(d.paramnames[i]+"\x3d"+encodeURI('"')),p;for(p in d.files[i])h+=encodeURI('"'+g[i]+"/"+d.files[i][p].name+'"'),d.files[i].length-1>Number(p)&&(h+=encodeURI(" "));h+=encodeURI('"');h+="\x26"}h+=this._toParameterString({opt_responseformat:"json",
token:this.token})+"\x26"+(b||"");this._ajax(a+h).then(c.hitch(this,function(a){k.resolve(a)}));return k},_v3_runDataDownload:function(a,b,g){var d=new f;a=this.serverUrl+"/fmedatadownload/"+a+"/"+b;g=this._toParameterString({opt_responseformat:"json",opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v3_runDataStreaming:function(a,b,g){var d=new f;a=this.serverUrl+
"/fmedatastreaming/"+a+"/"+b;g=this._toParameterString({opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"GET",g,"application/x-www-form-urlencoded;charset\x3dutf-8","application/octet-stream").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v3_runJobSubmitter:function(a,b,g){var d=new f;a=this.serverUrl+"/fmejobsubmitter/"+a+"/"+b;g=this._toParameterString({opt_responseformat:"json",opt_showresult:!0,token:this.token})+"\x26"+(g||"");this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,
function(a){d.resolve(a)}));return d},_v3_submitJob:function(a,b,g){var d=new f;this._ajax(this.restUrl+"/transformations/submit/"+a+"/"+b,"POST",g,"application/json").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v3_submitSyncJob:function(a,b,g){var d=new f;this._ajax(this.restUrl+"/transformations/transact/"+a+"/"+b,"POST",g,"application/json").then(c.hitch(this,function(a){d.resolve(a)}));return d},_v3_generateToken:function(a,b,g,d){var k=new f,h=this.serverUrl+"/fmetoken/service/generate";
a=this._toParameterString({user:a,password:b,expiration:g,timeunit:d});this._ajax(h,"POST",a,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){a.success?k.resolve(a.data):k.resolve(a)}));return k},_v3_getRepositories:function(){var a=new f;this._ajax(this.restUrl+"/repositories").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v3_getResources:function(){var a=new f;this._ajax(this.restUrl+"/resources/types").then(c.hitch(this,
function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v3_getWorkspacesForRepository:function(a){var b=new f;this._ajax(this.restUrl+"/repositories/"+a+"/items").then(c.hitch(this,function(a){a.success?b.resolve(a.data):b.resolve(a)}));return b},_v3_getWorkspaceParameters:function(a,b){var g=new f;this._ajax(this.restUrl+"/repositories/"+a+"/items/"+b+"/parameters").then(c.hitch(this,function(a){a.success?g.resolve(a.data):g.resolve(a)}));return g},_v3_getWorkspaceInfo:function(a,b){var g=
new f;this._ajax(this.restUrl+"/repositories/"+a+"/items/"+b).then(c.hitch(this,function(a){a.success?g.resolve(a.data):g.resolve(a)}));return g},_v3_getSession:function(a,b,g){var d=new f;a=this.serverUrl+"/fmedataupload/"+a+"/"+b;b={opt_extractarchive:!1,opt_pathlevel:3,opt_fullpath:!0,token:this.token};g&&(b.opt_namespace=g);g=this._toParameterString(b);this._ajax(a,"POST",g,"application/x-www-form-urlencoded;charset\x3dutf-8").then(c.hitch(this,function(a){a.success?d.resolve(a.data):d.resolve(a)}));
return d},_v3_dataUpload:function(a,b,g,d){var k=new f;d=d||null;a=this.serverUrl+"/fmedataupload/"+a+"/"+b;b={opt_extractarchive:!0,opt_pathlevel:3,opt_fullpath:!0};d&&(b.opt_namespace=d);a+="?"+this._toParameterString(b);d=new FormData;for(b=0;b<g.files.length;b++)d.append("files[]",g.files[b]);d.append("token",this.token);this._ajax(a,"POST",d).then(c.hitch(this,function(a){a.success?k.resolve(a.data):k.resolve(a)}));return k},_v3_getRunningJobs:function(){var a=new f;this._ajax(this.restUrl+"/transformations/jobs/running").then(c.hitch(this,
function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v3_getQueuedJobs:function(){var a=new f;this._ajax(this.restUrl+"/transformations/jobs/queued").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_v3_getInfo:function(){var a=new f;this._ajax(this.restUrl+"/info").then(c.hitch(this,function(b){b.success?a.resolve(b.data):a.resolve(b)}));return a},_toParameterString:function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&(b+=c+"\x3d"+a[c]+"\x26");return-1!==
b.indexOf("\x26")?b.slice(0,-1):b}})})},"app/FMEPortal/Utils":function(){define(["dojo/dom-style"],function(l){return{show:function(c){c&&l.set(c,"display","block")},hide:function(c){c&&l.set(c,"display","none")},toggle:function(c){c&&("none"===l.get(c,"display")?l.set(c,"display","block"):l.set(c,"display","none"))}}})},"app/FMEPortal/Login":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/text!./templates/login.html dojo/keys dojo/i18n!./nls/resources dijit/layout/TabContainer dijit/layout/ContentPane dijit/form/ValidationTextBox dijit/form/Form dijit/form/Button dijit/form/CheckBox dijit/layout/TabController".split(" "),
function(l,c,f,a,b,g,d,k,h,p){return l("FmePortal-Login",[f,a,b,g],{templateString:k,widgetsInTemplate:!0,constructor:function(a){this.options=a;this.nls=p},postCreate:function(){this.inherited(arguments);this._adminMode.set("checked",this.options.settings.fme.server.adminMode);this.own(d(this._login,"click",c.hitch(this,function(){this._loginStatus.innerHTML="";this._fmeLoginForm.validate()&&this.emit("login",this._fmeLoginForm.get("value"),this._getSettings())})),d(this._tokenLogin,"click",c.hitch(this,
function(){this._tokenStatus.innerHTML="";this._fmeTokenForm.validate()&&this.emit("tokenLogin",this._fmeTokenForm.get("value"),this._getSettings())})),d(this._fmeLoginForm,"keydown",c.hitch(this,function(a){var b=!1;void 0!==a.keyCode&&a.keyCode===h.ENTER&&(this._fmeLoginForm.validate()&&this.emit("login",this._fmeLoginForm.getValues()),b=!0);b&&a.preventDefault()})))},startup:function(){this.inherited(arguments);this._tabContainer.startup();this.options.settings.fme.server.token.showTokenTab||this._tokenTab.controlButton.set("disabled",
!0);this.options.settings.fme.server.showSettingsTab||this._settingsTab.controlButton.set("disabled",!0)},setTokenStatus:function(a){this._tokenStatus.innerHTML=a},setLoginStatus:function(a){this._loginStatus.innerHTML=a},_getSettings:function(){return{adminMode:this._adminMode.get("checked"),url:this._serverUrl.get("value")}},destroy:function(){this.inherited(arguments)}})})},"app/FMEPortal/nls/resources":function(){define({root:{Login:{Tabs:{Credentials:{Title:"Sign in",Info:"Sign in to access FME-server",
Username:"Username",Password:"Password"},Token:{Title:"Token sign in",Info:"Enter token to sign in to FME-server",Token:"Valid token"},Settings:{Title:"Settings",Info:"Setup FME-server information",ServerUrl:"FME-server URL",AdminMode:{Info:"Start the portal in admin mode to automatically retrieve all repositorys and workspaces the active user has access too.",Label:"Use admin mode"}}},SignedInAs:"You are signed in as ",TokenSignIn:"You signed in using a token",Button:"Sign in",ButtonSignout:"Sign out",
Messages:{Expired:"Your session expired, sign in again!",BadLogin:"Bad login, wrong username or password?",NoAccess:"Cant access the FME-server at {url}",NoPermission:"You don't have permission to access this FME-server.",NoWorkspacePermission:"You don't have permission to access this workspace.",BadToken:"Invalid token or server settings."}},Widget:{About:"About",Step1:{Title:"Step 1: Draw clipping area"},Step2:{Title:"Step 2: Select workspace, set parameters and run!",LoadingParams:"Loading parameters...",
LoadingContent:"Loading content...",ChooseWorkspace:"Choose Workspace",Repository:"Repository",Workspace:"Workspace"},Step3:{Title:"Step 3: Results",LoadingResult:"Waiting for workspace results...",ClearResult:"Clear",NoTranslationResults:"No translation results yet..."}},GenerateForms:{NumberTextBox:{IntegerMessage:"The value must be integer",NumberMessage:"The value must be a number",MinMaxMessage:"Input a number between {min} and {max}",MinMaxPlaceholder:"min {min}, max {max}"},ColorPicker:{SelectColor:"Select a color"},
Results:{Success:"Translation Successful",Download:"Download results...",Count:"written features",ViewStreamingResult:"View data streaming results",Email:"Your job with ID {jobID} was successfully sent to FME-server. The translation results will be emailed to {email}."},ButtonOrder:"Run",Error:{ServiceType:"Service type {type} is not supported.",Unknown:"Unknown error!","No output dataset":"No output dataset was produced by FME transformation","Fatal error":"A fatal error occured","Missing geometry":"A geometry is missing",
"Transformation failed":"The transformation failed","Unauthorized request":"Unauthorized request","No transformation result":"No transformation result"},EmailResults:"Email the results",EmailPlaceholder:"Enter email"},FileUpload:{AddFiles:"Add file(s)",SelectFiles:"Select file(s)",SelectTranslationFiles:"Select file(s) for the translation",Button:"Upload file(s)",Uploading:"Uploading file(s)...",NoFiles:"No uploaded file(s)",FileList:{Name:"Name",Size:"Size",Type:"Type"}},WorkspaceInfo:{ButtonLabel:"Workspace Information",
Label:"Workspace information about",Title:"Title",Build:"FME Build number",Filesize:"File Size",Category:"Category",Description:"Description",History:"History",LastSaveBuild:"FME last save build number",LastSaveDate:"FME last save date",Resources:"File resources",Services:"Registered services",Type:"Type of resource",Usage:"Usage info"},Status:{Title:"FME-server status",RunningJobs:"Running jobs",NoRunningJobs:"No running jobs.",QueuedJobs:"Queued jobs",NoQueuedJobs:"No queued jobs."},Toolbar:{NoMap:"This portal is not connected to a map.",
Message:"Select a workspace to enable drawing tools.",Area:"The drawing cover {area} hectares.",Edit:"Click somewhere outside the edited geometry to save it.",DrawMultiple:"Draw multiple clipping areas",HasIntersections:"Intersecting clipping areas are not allowed.",Coordinates:"Coordinates",InputExtent:{Title:"Input extent coordinates",Input:"Input",xmin:"x-min",ymin:"y-min",xmax:"x-max",ymax:"y-max",Validation:{Coordinates:"Input valid coordinates"},ButtonDraw:"Draw extent",InvalidCoordinates:"Invalid coordinates!"},
Buffer:{UseBuffer:"Set",SetBuffer:"Set buffer"}}},sv:!0})},"app/FMEPortal/nls/sv/resources":function(){define({Login:{Tabs:{Credentials:{Title:"Logga in",Info:"Logga in f\u00f6r att komma \u00e5t FME-server",Username:"Anv\u00e4ndarnamn",Password:"L\u00f6senord"},Token:{Title:"Logga in med token",Info:"Ange token f\u00f6r att logga in till FME-server",Token:"Giltig token"},Settings:{Title:"Inst\u00e4llningar",Info:"St\u00e4ll in FME-server info",ServerUrl:"FME-server url",AdminMode:{Info:"Starta i administrat\u00f6rsl\u00e4ge f\u00f6r att automatiskt h\u00e4mta alla kataloger och skript som den aktiva anv\u00e4ndaren har \u00e5tkomst till.",
Label:"Anv\u00e4nd administrat\u00f6rsl\u00e4ge"}}},SignedInAs:"Du \u00e4r inloggad som ",TokenSignIn:"Du har loggat in med en token",Button:"Logga in",ButtonSignout:"Logga ut",Messages:{Expired:"Din session har g\u00e5tt ut, logga in p\u00e5 nytt!",BadLogin:"Felaktig inloggning, fel anv\u00e4ndarnamn eller l\u00f6senord?",NoAccess:"Kan inte komma FME-servern p\u00e5 {url}",NoPermission:"Du har ingen beh\u00f6righet p\u00e5 denna FME-server.",NoWorkspacePermission:"Du har inte beh\u00f6righet till detta FME-skript.",
BadToken:"Felaktig token eller server-inst\u00e4llning."}},Widget:{About:"Om",Step1:{Title:"Steg 1: Rita en klippyta"},Step2:{Title:"Steg 2: V\u00e4lj FME-skript, st\u00e4ll in parametrar och k\u00f6r!",LoadingParams:"Laddar formul\u00e4r...",LoadingContent:"Laddar inneh\u00e5ll...",ChooseWorkspace:"V\u00e4lj FME-skript",Repository:"Katalog",Workspace:"FME-skript"},Step3:{Title:"Steg 3: Resultat",LoadingResult:"Inv\u00e4ntar resultat...",ClearResult:"Rensa",NoTranslationResults:"Inga resultat \u00e4nnu..."}},
GenerateForms:{NumberTextBox:{IntegerMessage:"V\u00e4rdet m\u00e5ste vara ett heltal.",NumberMessage:"V\u00e4rdet m\u00e5ste vara ett tal.",MinMaxMessage:"Ange ett v\u00e4rde mellan {min} och {max}",MinMaxPlaceholder:"min {min}, max {max}"},ColorPicker:{SelectColor:"V\u00e4lj en f\u00e4rg"},Results:{Success:"K\u00f6rningen lyckades!",Download:"Ladda ned resultatet",Count:"Skrivna objekt/poster",ViewStreamingResult:"Visa resultat fr\u00e5n data streaming-tj\u00e4nsten",Email:"Ditt jobb med ID \x3cb\x3e{jobID}\x3c/b\x3e har skickats till FME-server. Resultatet kommer att skickas till \x3cb\x3e{email}\x3c/b\x3e."},
ButtonOrder:"K\u00f6r",Error:{ServiceType:"Servicetypen {type} st\u00f6ds inte.",Unknown:"Ok\u00e4nd fel!","No output dataset":"Inget utdata skapades vid FME-k\u00f6rningen.","Fatal error":"Ett allvarligt fel intr\u00e4ffade","Missing geometry":"En geometri saknas","Transformation failed":"N\u00e5got gick fel vid k\u00f6rningen","Unauthorized request":"Obeh\u00f6rigt anrop","No transformation result":"K\u00f6rningen gav inget resultat."},EmailResults:"Maila resultatet",EmailPlaceholder:"Ange e-post"},
FileUpload:{AddFiles:"L\u00e4gg till fil(er)",SelectFiles:"V\u00e4lj fil(er)",SelectTranslationFiles:"V\u00e4lj fil(er) till FME-skriptet",Button:"Ladda upp fil(er)",Uploading:"Laddar upp fil(er)...",NoFiles:"Inga uppladdade fil(er)",FileList:{Name:"Namn",Size:"Storlek",Type:"Typ"}},WorkspaceInfo:{ButtonLabel:"Information om FME-skriptet",Label:"Information om FME-skriptet ",Title:"Titel",Build:"FME Build version",Filesize:"Filstorlek",Category:"Kategori",Description:"Beskrivning",History:"Historik",
LastSaveBuild:"Senast sparad med FME build version",LastSaveDate:"Senast sparad",Resources:"Filresurser",Services:"Registrerade tj\u00e4nster",Type:"Typ av resurs",Usage:"Information om anv\u00e4ndning"},Status:{Title:"FME-server status",RunningJobs:"P\u00e5g\u00e5ende jobb",NoRunningJobs:"Inga p\u00e5g\u00e5ende jobb.",QueuedJobs:"Jobb i k\u00f6",NoQueuedJobs:"Inga jobb i k\u00f6."},Toolbar:{NoMap:"Portalen \u00e4r inte kopplad till en karta.",Message:"V\u00e4lj ett FME-skript f\u00f6r att aktivera ritverktyg.",
Area:"Ritningen t\u00e4cker {area} hektar.",Edit:"Klicka utanf\u00f6r den \u00e4ndrade ytan f\u00f6r att spara.",Coordinates:"Koordinater",DrawMultiple:"Rita flera klippytor",HasIntersections:"\u00d6verlappande klippytor till\u00e5ts inte.",InputExtent:{Title:"Ange utbredningskoordinater",Input:"Ange",xmin:"x-min",ymin:"y-min",xmax:"x-max",ymax:"y-max",Validation:{Coordinates:"Ange giltiga koordinater"},ButtonDraw:"Rita utbredning",InvalidCoordinates:"Ogiltiga koordinater!"},Buffer:{UseBuffer:"Ange",
SetBuffer:"Ange buffert"}}})},"app/FMEPortal/WorkspaceInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/workspace-info.html dojo/i18n!./nls/resources".split(" "),function(l,c,f,a,b,g,d,k,h){return l("FmePortal-Workspace-Info",[a,b,g,d],{templateString:k,widgetsInTemplate:!0,baseClass:"fmeportal",options:{},constructor:function(a){this.options=c.mixin(this.options,a);
this.nls=h;a=this.options.history.split(",");this.options.history="";f.forEach(a,c.hitch(this,function(a,b){this.options.history+=a+" ";0===(b+1)%3&&(this.options.history+="\x3cbr/\x3e")}));var b="";f.forEach(this.options.resources,c.hitch(this,function(a){b+=a.name+"\x3cbr/\x3e"}));this.options.resources=b;var d="";f.forEach(this.options.services,c.hitch(this,function(a){d+=a.displayName+"\x3cbr/\x3e"}));this.options.services=d},postCreate:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments)}})})},
"app/FMEPortal/GenerateForms":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/text!./templates/workspace-form.html dojo/text!./templates/result.html dojo/dom-style dojo/dom-construct dojo/dom dojo/topic dijit/registry dojo/data/ObjectStore dojo/store/Memory ./Utils dojo/i18n!./nls/resources ./FileUpload dijit/form/TextBox dijit/form/Select dijit/form/Form dijit/form/Button dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/ValidationTextBox dijit/form/Textarea dojox/form/CheckedMultiSelect dijit/form/DropDownButton esri/dijit/ColorPicker esri/Color dojox/validate".split(" "),
function(l,c,f,a,b,g,d,k,h,p,q,m,v,n,y,u,A,w,C,z,x,D,r,I,F,G,H,E,B,J,K,t){return l("FmePortal-GenerateForms",[a,b,g,d],{templateString:h,widgetsInTemplate:!0,constructor:function(a){this.options=c.mixin({},this.options,a.options);this.nls=C;this.FMERestManager=a.restManager;this._parameters=a.parameters;this._repository=a.ws.repo;this._workspace=a.ws.id;this._type=a.ws.service;this._startGeometry=a.geometry||null;this._label=a.ws.label;a.ws&&a.ws.description&&a.ws.label?(this.title=a.ws.label+" \x3ci class\x3d'material-icons'\x3e\x26#xE887;\x3c/i\x3e",
this.description=a.ws.description):(this.title=a.ws.id,this.description=null);this._addTopics()},_addTopics:function(){this.own(n.subscribe("FMEPortal/disableOrderButton",c.hitch(this,function(){this._order&&this._order.set("disabled",!0)})),n.subscribe("FMEPortal/enableOrderButton",c.hitch(this,function(){this._order&&this._order.set("disabled",!1)})),n.subscribe("FMEPortal/orderStart",c.hitch(this,function(){this._order&&this._order.set("disabled",!0)})),n.subscribe("FMEPortal/orderComplete",c.hitch(this,
function(){this._order&&this._order.set("disabled",!1)})))},postCreate:function(){this.inherited(arguments);this._activeFileUploads=[];this.options.settings.fme.server.allowAsyncJobs?(this.own(k(this._serviceMode,"change",c.hitch(this,function(){var a=this._serviceMode.get("checked")?"block":"none";q.set(this._email.domNode,"display",a)}))),this._type&&"fmedatastreaming"===this._type&&w.hide(this._serviceModeContainer)):m.destroy(this._serviceModeContainer);f.forEach(this._parameters,c.hitch(this,
function(a){var e=[this.options.settings.fme.geometry.parameter];this.options.settings.adminMode||e.push("FME_SERVER_DEST_DIR");e=-1!==e.indexOf(a.name);switch(a.type){case "NOVALUE":this._generateTextBox(a,e);break;case "LOOKUP_CHOICE":this._generateSelect(a,e);break;case "CHOICE":this._generateCheckBox(a,e);break;case "TEXT":this._generateTextBox(a,e);break;case "PASSWORD":this._generatePasswordTextBox(a,e);break;case "FLOAT":this._generateNumberTextBox(a,e,"float");break;case "INTEGER":this._generateNumberTextBox(a,
e,"integer");break;case "RANGE_SLIDER":this._generateNumberTextBox(a,e,"minmax");break;case "FILE_OR_URL":this._generateUpload(a,e);break;case "MULTIFILE":this._generateUpload(a,e);break;case "FILENAME_MUSTEXIST":this._generateTextBox(a,e,!0);break;case "FILENAME":this._generateTextBox(a,e,!0);break;case "TEXT_EDIT":this._generateTextarea(a,e);break;case "LOOKUP_LISTBOX":this._generateMultiSelect(a,e);break;case "LISTBOX":this._generateMultiSelect(a,e);break;case "COLOR_PICK":this._generateColorPicker(a,
e);break;default:this._generateTextBox(a,e)}}));this.own(k(this._order,"click",c.hitch(this,this._runOrder)));this.title&&this.description&&(w.show(this._title),this.own(k(this._title,"click",c.hitch(this,function(){w.toggle(this._description)}))))},addServiceSelect:function(a){var e=[];f.forEach(a.services,function(a){e.push({label:a.displayName,value:a.name})});w.show(this._serviceType);this._serviceSelect=(new D({id:"fmeportal-service-select",name:"service",options:e,style:"width:185px"},this._serviceType)).startup();
"fmedatastreaming"===y.byId("fmeportal-service-select").get("value")&&this._serviceModeContainer&&w.hide(this._serviceModeContainer);this.own(y.byId("fmeportal-service-select").on("change",c.hitch(this,function(){"fmedatastreaming"===y.byId("fmeportal-service-select").get("value")&&this._serviceModeContainer?w.hide(this._serviceModeContainer):w.show(this._serviceModeContainer)})))},setGeometry:function(a){this._geometryBox&&a&&0<a.length?this._geometryBox.set("value",a):this._geometryBox&&this._geometryBox.set("value",
"")},_runOrder:function(){if(this._form.validate()){var a=this._form.get("value");y.byId("fmeportal-service-select")&&(this._type=y.byId("fmeportal-service-select").get("value"));if(this.options.settings.fme.server.allowAsyncJobs&&this._serviceMode.get("checked"))if(this._email.isValid()&&this._email.get("value"))a=c.mixin({},a,{opt_servicemode:"async",opt_requesteremail:this._email.get("value")});else{this._email.focus();return}n.publish("FMEPortal/orderStart");var b=this._processValuesToString(a);
this._processValuesToObject(a);if(this._activeFileUploads&&0<this._activeFileUploads.length){var b={paramnames:[],files:[],params:b,service:this._type},d=[];f.forEach(this._activeFileUploads,c.hitch(this,function(a){var e=a.getValues();e&&e.files&&(b.paramnames.push(a.get("paramname")),b.files.push(e.files),d.push(a.get("path")))}));switch(this._type){case "fmedatadownload":this.FMERestManager.runWorkspaceWithData(this._repository,this._workspace,d,b).then(c.hitch(this,this._resultDataDownload));
break;case "fmejobsubmitter":this.FMERestManager.runWorkspaceWithData(this._repository,this._workspace,d,b).then(c.hitch(this,this._resultJobSubmitter));break;case "fmedatastreaming":this.FMERestManager.runWorkspaceWithData(this._repository,this._workspace,d,b).then(c.hitch(this,this._resultDataStreaming));break;default:a={resultClass:"error",date:this.nls.GenerateForms.Error["No transformation result"],message:c.replace(this.nls.GenerateForms.Error.ServiceType,{type:this._type}),workspace:this._label||
this._workspace,icon:"\x26#xE86C;"},n.publish("FMEPortal/orderComplete",m.toDom(c.replace(p,a)))}}else switch(this._type){case "fmedatadownload":this.FMERestManager.runDataDownload(this._repository,this._workspace,b).then(c.hitch(this,this._resultDataDownload));break;case "fmejobsubmitter":this.FMERestManager.runJobSubmitter(this._repository,this._workspace,b).then(c.hitch(this,this._resultJobSubmitter));break;case "fmedatastreaming":this.FMERestManager.runDataStreaming(this._repository,this._workspace,
b).then(c.hitch(this,this._resultDataStreaming));break;default:a={resultClass:"error",date:this.nls.GenerateForms.Error["No transformation result"],message:c.replace(this.nls.GenerateForms.Error.ServiceType,{type:this._type}),workspace:this._label||this._workspace,icon:"\x26#xE86C;"},n.publish("FMEPortal/orderComplete",m.toDom(c.replace(p,a)))}}},_resultDataDownload:function(a){a=a.data;var e={resultClass:"success",date:null,message:null,workspace:this._label||this._workspace,icon:"\x26#xE86C;"};
if(a&&a.serviceResponse&&a.serviceResponse.statusInfo&&"success"===a.serviceResponse.statusInfo.status)if(a.serviceResponse.statusInfo.mode&&"async"===a.serviceResponse.statusInfo.mode)e.date=(new Date).toISOString(),e.message=c.replace(this.nls.GenerateForms.Results.Email,a.serviceResponse);else if(e.date=a.serviceResponse.fmeTransformationResult.fmeServerResponse.timeFinished,a.serviceResponse.url)e.message="\x3ci class\x3d'material-icons'\x3e\x26#xE2C4;\x3c/i\x3e\x3ca href\x3d'"+a.serviceResponse.url+
"'\x3e"+this.nls.GenerateForms.Results.Download+"\x3c/a\x3e";else{var b=a.serviceResponse.fmeTransformationResult.fmeEngineResponse;e.message=this._checkSuccessMessage(b.statusMessage)+", "+b.numFeaturesOutput+" "+this.nls.GenerateForms.Results.Count}else e.resultClass="error",e.date=a.serviceResponse.fmeTransformationResult?a.serviceResponse.fmeTransformationResult.fmeServerResponse.timeFinished:this.nls.GenerateForms.Error["No transformation result"],e.message=this._checkErrorMessage(a.serviceResponse.statusInfo.message),
e.icon="\x26#xE000;";n.publish("FMEPortal/orderComplete",m.toDom(c.replace(p,e)),a)},_resultJobSubmitter:function(a){a=a.data;var e={resultClass:"success",date:null,message:null,workspace:this._label||this._workspace,icon:"\x26#xE86C;"};if(a&&a.serviceResponse&&a.serviceResponse.statusInfo&&"success"===a.serviceResponse.statusInfo.status)if(a.serviceResponse.statusInfo.mode&&"async"===a.serviceResponse.statusInfo.mode)e.date=(new Date).toISOString(),e.message=c.replace(this.nls.GenerateForms.Results.Email,
a.serviceResponse);else{var b=a.serviceResponse.fmeTransformationResult.fmeEngineResponse;e.date=a.serviceResponse.fmeTransformationResult.fmeServerResponse.timeFinished;e.message=this._checkSuccessMessage(b.statusMessage)+", "+b.numFeaturesOutput+" "+this.nls.GenerateForms.Results.Count}else a&&"SUCCESS"===a.status?(e.date=a.timeFinished,e.message=this._checkSuccessMessage(a.statusMessage)+", "+a.numFeaturesOutput+" "+this.nls.GenerateForms.Results.Count):(e.resultClass="error",a.timeFinished?(e.date=
a.timeFinished||this.nls.GenerateForms.Error["No transformation result"],e.message=this._checkErrorMessage(a.statusMessage||a.serviceResponse.statusInfo.message)):(e.date=a.serviceResponse.fmeTransformationResult?a.serviceResponse.fmeTransformationResult.fmeServerResponse.timeFinished:this.nls.GenerateForms.Error["No transformation result"],e.message=this._checkErrorMessage(a.serviceResponse.statusInfo.message)),e.icon="\x26#xE000;");n.publish("FMEPortal/orderComplete",m.toDom(c.replace(p,e)),a)},
_streamingCount:0,_resultDataStreaming:function(a){type=a.responseType;a=a.data;var e={resultClass:"success",date:null,message:null,workspace:this._label||this._workspace,icon:"\x26#xE86C;"};a?(a="object"===typeof a?"\x3cpre style\x3d'width:600px;'\x3e"+JSON.stringify(a,null,4)+"\x3c/pre\x3e":"\x3cpre style\x3d'width:600px;'\x3e"+this._escapeHTML(a)+"\x3c/pre\x3e",this._streamingCount+=1,e.date=(new Date).toISOString(),e.message=this.nls.GenerateForms.Results.Success+" \x3ca style\x3d'cursor:pointer;' id\x3d'"+
this.id+"-streaming-"+this._streamingCount+"'\x3e\x3ci class\x3d'material-icons'\x3e\x26#xE8F4;\x3c/i\x3e "+this.nls.GenerateForms.Results.ViewStreamingResult+"\x3c/a\x3e"):(e.resultClass="error",e.message=this.nls.GenerateForms.Error["No output dataset"],e.icon="\x26#xE000;");n.publish("FMEPortal/orderComplete",m.toDom(c.replace(p,e)));a&&k(v.byId(this.id+"-streaming-"+this._streamingCount),"click",function(){n.publish("FMEPortal/alert","FME-portal Data Streaming",a)})},_escapeHTML:function(a){return a.replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;")},_checkErrorMessage:function(a){if(a){var e=a;this._isNumber(a.slice(-5,-2))&&this.options.settings.fme.customErrors?e=this.options.settings.fme.customErrors[a.slice(-5,-2)]||this.nls.GenerateForms.Error.Unknown:(e=e.contains("No output dataset was produced by FME transformation")?this.nls.GenerateForms.Error["No output dataset"]:e,e=e.contains("A fatal error has occurred")?this.nls.GenerateForms.Error["Fatal error"]:e,e=e.contains("Parameter '"+
this.options.settings.fme.geometry.parameter+"' must be given a value.")?this.nls.GenerateForms.Error["Missing geometry"]:e,e=e.contains("FME Server transformation failed: ")?e.replace("FME Server transformation failed: ",""):e,e=e.contains("Unauthorized request")?this.nls.GenerateForms.Error["Unauthorized request"]:e,e.contains("Authentication failed")&&n.publish("FMEPortal/showLogin"));return e}},_checkSuccessMessage:function(a){if(a)return a=a.contains("Translation Successful")?this.nls.GenerateForms.Results.Success:
a},_isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},_processValuesToString:function(a){var e="",b,c,d,g,t;for(t in a)a.hasOwnProperty(t)&&(b=a[t],"string"===typeof b?(d=!1,g=this._form.getChildren(),f.forEach(g,function(a){a.name===t&&a.isEditText&&(d=!0)}),e=d?e+(t+"\x3d"+encodeURIComponent(this._convertMultilineText(t,b))+"\x26"):e+(t+"\x3d"+encodeURIComponent(b)+"\x26")):"number"===typeof b?isNaN(b)||(e+=t+"\x3d"+b+"\x26"):(c=!1,g=this._form.getChildren(),f.forEach(g,function(a){a.name===
t&&a.isCheckbox&&(c=!0)}),e=c?e+(0===b.length?t+"\x3dNo\x26":t+"\x3dYes\x26"):e+(t+"\x3d"+encodeURIComponent(b.toString())+"\x26")));return e},_processValuesToObject:function(a){var e={publishedParameters:[]},b,c,d,g,t;for(c in a)a.hasOwnProperty(c)&&(b=a[c],"string"===typeof b?(t=!1,g=this._form.getChildren(),f.forEach(g,function(a){a.name===c&&a.isEditText&&(t=!0)}),t?e.publishedParameters.push({name:c,value:this._convertMultilineText(c,b)}):e.publishedParameters.push({name:c,value:b})):"number"===
typeof b?isNaN(b)||e.publishedParameters.push({name:c,value:b}):(d=!1,g=this._form.getChildren(),f.forEach(g,function(a){a.name===c&&a.isCheckbox&&(d=!0)}),d?e.publishedParameters.push({name:c,value:0===b.length?"No":"Yes"}):e.publishedParameters.push({name:c,value:b})));return e},_generateSelect:function(a,b){var e=[];f.forEach(a.listOptions,function(b){b={label:b.caption,value:b.value};b.value===a.defaultValue&&(b.selected=!0);e.push(b)});b=this._generateContainer(a,b);(new D({name:a.name,options:e,
style:"width:185px"})).placeAt(b,"last").startup()},_generateCheckBox:function(a,b){if("Yes"===a.defaultValue||"No"===a.defaultValue)b=this._generateContainer(a,b),a=(new F({name:a.name,checked:"Yes"===a.defaultValue})).placeAt(b,"last"),a.startup(),a.set("isCheckbox",!0)},_generateTextBox:function(a,b,c){b=this._generateContainer(a,b);a.name===this.options.settings.fme.geometry.parameter?(this._geometryBox=a=new x({name:a.name,value:this._startGeometry||"",style:"width:185px"}),n.publish("FMEPortal/showGeometryTools")):
a=new x({name:a.name,value:a.defaultValue,style:"width:185px"});a.placeAt(b,"last");c&&a.set("disabled",!0)},_generateTextarea:function(a,b){if(a.name===this.options.settings.fme.geometry.parameter)this._generateTextBox(a,b);else{b=this._generateContainer(a,b);var e=this._convertMultilineText(null,a.defaultValue,!0);a=new E({name:a.name,value:e,style:"width:185px"});a.startup();a.set("isEditText",!0);a.placeAt(b,"last")}},_generatePasswordTextBox:function(a,b){b=this._generateContainer(a,b);(new H({type:"password",
name:a.name,value:a.defaultValue,style:"width:185px"})).placeAt(b,"last")},_generateNumberTextBox:function(a,b,d){b=this._generateContainer(a,b);var e={name:a.name,value:Number(a.defaultValue),style:"width:185px"};"integer"===d&&(e.constraints={places:0},e.invalidMessage=this.nls.GenerateForms.NumberTextBox.IntegerMessage);"float"===d&&(e.invalidMessage=this.nls.GenerateForms.NumberTextBox.NumberMessage);"minmax"===d&&(e.constraints={min:a.minimum,max:a.maximum},e.invalidMessage=c.replace(this.nls.GenerateForms.NumberTextBox.MinMaxMessage,
{min:a.minimum,max:a.maximum}),e.placeholder=c.replace(this.nls.GenerateForms.NumberTextBox.MinMaxPlaceholder,{min:a.minimum,max:a.maximum}));(new G(e)).placeAt(b,"last")},_generateMultiSelect:function(a,b){b=this._generateContainer(a,b);var e=[];f.forEach(a.listOptions,function(a){e.push({id:a.value,label:a.caption})});var c=new u({objectStore:new A({data:e})});(new B({name:a.name,store:c,style:"width:185px;border:0;",multiple:!0})).placeAt(b,"last").set("value",a.defaultValue)},_generateColorPicker:function(a,
b){var e=this._generateContainer(a,b);b=a.defaultValue.split(",");var c;3===b.length&&(c=new t([parseInt(255*b[0]),parseInt(255*b[1]),parseInt(255*b[2])]),q.set(e,"background","rgb("+c.r+","+c.g+","+c.b+")"));var d=new K({color:c||new t([255,255,255]),showTransparencySlider:!1,showRecentColors:!1,required:!1});(new J({label:this.nls.GenerateForms.ColorPicker.SelectColor,style:"width:185px",dropDown:d})).placeAt(e,"last").startup();var f=(new x({name:a.name,value:a.defaultValue,style:"display:none;"})).placeAt(e,
"last");d.on("color-change",function(a){q.set(e,"background","rgb("+d.color.r+","+d.color.g+","+d.color.b+")");f.set("value",(d.color.r/255).toFixed(3)+","+(d.color.g/255).toFixed(3)+","+(d.color.b/255).toFixed(3))})},_generateContainer:function(a,b,c){var e=m.create("li",{"class":"fmeportal-formitem"});a=m.create("div",{"class":"fmeportal-caption",innerHTML:a.description});var d=m.create("div",{"class":"fmeportal-element"});m.place(e,this._formList,"last");b&&w.hide(e);if(c)return e;m.place(a,e,
"last");m.place(d,e,"last");return d},_generateUpload:function(a,b){b=this._generateContainer(a,b,!0);a=new z({settings:this.options.settings,repository:this._repository,workspace:this._workspace,parameter:{name:a.name,description:a.description},restManager:this.FMERestManager});this._activeFileUploads.push(a);a.placeAt(b,"last")},_convertMultilineText:function(a,b,c){if(a===this.options.settings.fme.geometry.parameter)return b;a="";return a=c?b?b.replaceAll("\x3cspace\x3e"," ").replaceAll("\x3clf\x3e",
"\n").replaceAll("\x3cu00e5\x3e","\u00e5").replaceAll("\x3cu00f6\x3e","\u00f6").replaceAll("\x3cu00e4\x3e","\u00e4").replaceAll("\x3cu00c5\x3e","\u00c5").replaceAll("\x3cu00c4\x3e","\u00c4").replaceAll("\x3cu00d6\x3e","\u00d6"):"":b?b.replaceAll(" ","\x3cspace\x3e").replaceAll("\n","\x3clf\x3e").replaceAll("\u00e5","\x3cu00e5\x3e").replaceAll("\u00f6","\x3cu00f6\x3e").replaceAll("\u00e4","\x3cu00e4\x3e").replaceAll("\u00c5","\x3cu00c5\x3e").replaceAll("\u00c4","\x3cu00c4\x3e").replaceAll("\u00d6",
"\x3cu00d6\x3e"):""}})})},"app/FMEPortal/FileUpload":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/on dojo/text!./templates/file-upload.html dojo/dom-class dojo/dom-construct dojo/query ./Utils dojo/i18n!./nls/resources dojox/form/uploader/FileList dijit/form/CheckBox dijit/form/Form dojox/form/Uploader dijit/form/Button dijit/form/TextBox".split(" "),function(l,c,f,a,b,g,d,k,h,p,q,m,v,n,y,
u){return c("FmePortal-FileUpload",[b,g,d],{templateString:h,widgetsInTemplate:!0,constructor:function(a){this.options=a;this.nls=n;this.FMERestManager=a.restManager;this.loaderAnim=l.toUrl("./images/loader.gif");this.set("paramname",this.options.parameter.name);this.set("description",this.options.parameter.description);this.set("disabledFiles",this.options.settings.fme.uploadSettings.disabledFiles);this.FMERestManager.getSession(this.options.repository,this.options.workspace,this.FMERestManager.sessionId).then(f.hitch(this,
function(a){a.serviceResponse.files&&(this.set("session",a.serviceResponse.session),this.set("path",a.serviceResponse.files.folder[0].path))}))},postCreate:function(){this.inherited(arguments);this._uploader.startup();(new y({uploader:this._uploader,headerFilename:this.nls.FileUpload.FileList.Name,headerFilesize:this.nls.FileUpload.FileList.Size,headerType:this.nls.FileUpload.FileList.Type})).placeAt(this._fileList).startup();this.own(k(this._uploader,"change",f.hitch(this,function(a){a&&0<a.length?
v.show(this._fileContainer):v.hide(this._fileContainer)})),k(this._submit,"click",f.hitch(this,function(){v.show(this._uploading);var a=m("input",this._uploader.domNode)[0];this.FMERestManager.dataUpload(this.options.repository,this.options.workspace,a,this.get("session")).then(f.hitch(this,this._processUploadedFiles))})))},_processUploadedFiles:function(b){this._uploadedFilesList&&0<this._uploadedFilesList.length&&a.forEach(this._uploadedFilesList,function(a){a&&a.destroy()});this._uploadedFilesList=
[];if(void 0!==b.serviceResponse){this._uploadedFiles.innerHTML="";this._files=b.serviceResponse.files.file;var c,d;for(file in this._files)b=this._getLabelString(this._files[file]),b=q.toDom("\x3clabel\x3e "+b+"\x3c/label\x3e"),q.place(b,this._uploadedFiles,"last"),c=new u({name:this._files[file].name}),d=/\.[0-9a-z]{1,5}$/i,d=this._files[file].name.toLowerCase().match(d)[0],-1!==this.disabledFiles.indexOf(d)&&(c.set("disabled",!0),p.add(b,"fmeportal-disabled")),this._uploadedFilesList.push(c),c.placeAt(b,
"first"),c.startup();v.show(this._uploadedContainer)}v.hide(this._uploading)},getValues:function(){var b=[];this._uploadedFilesList&&0<this._uploadedFilesList.length&&a.forEach(this._uploadedFilesList,f.hitch(this,function(c){c.get("checked")&&a.forEach(this._files,function(a){c.get("name")===a.name&&b.push(a)})}));if(0<b.length)return{files:b}},_getLabelString:function(a){return a.name.replace("\u00c3\u00a4","\u00e4").replace("\u00c3\u00a5","\u00e5").replace("\u00c3\u00b6","\u00f6").replace("\u00c3\u2026",
"\u00c5").replace("\u00c3\u201e","\u00c4").replace("\u00c3\u2013","\u00d6")},destroy:function(){this.inherited(arguments)}})})},"app/FMEPortal/Status":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/status.html dojo/i18n!./nls/resources dojo/topic ./Utils".split(" "),function(l,c,f,a,b,g,d,k,h,p,q,m){return c("FmePortal-Status",[b,g,d,k],{templateString:h,widgetsInTemplate:!0,
options:{},constructor:function(a){this.options=f.mixin(this.options,a.settings);this.FMERestManager=a.restManager;this.nls=p;this._apiUrl=this.options.settings.fme.server.url;this._restVersion=this.options.settings.fme.server.version;this._addTopics()},postCreate:function(){this.inherited(arguments);this.options.settings.fme.server.adminMode||(m.hide(this._running),m.hide(this._queued));m.hide(this.domNode)},_addTopics:function(){this.own(q.subscribe("FMEPortal/orderStart",f.hitch(this,function(){this._statusInterval=
setInterval(f.hitch(this,this._queryFmeServerStatus),2E3)})),q.subscribe("FMEPortal/orderComplete",f.hitch(this,function(){clearInterval(this._statusInterval);m.hide(this.domNode)})))},_requestCompleteRunning:!0,_requestCompleteQueued:!0,_queryFmeServerStatus:function(){this._requestCompleteRunning&&(this._requestCompleteRunning=!1,this.FMERestManager.getRunningJobs().then(f.hitch(this,function(b){b&&(b.data||b.items)&&(b=b.data||b.items);b&&b.message&&b.message.contains("Unauthorized request")?(clearInterval(this._statusInterval),
this.destroy()):(m.show(this.domNode),this._requestCompleteRunning=!0,0===b.length?(this._runningTitle.innerHTML=this.nls.Status.RunningJobs+" (0)",this._running.innerHTML=this.nls.Status.NoRunningJobs):(this._runningTitle.innerHTML=this.nls.Status.RunningJobs+" ("+b.length+")",this._running.innerHTML="",a.forEach(b,f.hitch(this,function(a){this._running.innerHTML+="\x3cimg src\x3d'"+l.toUrl("./images/loader.gif")+"' /\x3e "+a.id+", "+a.request.workspacePath.split("/")[1]+" \x3cb\x3e"+a.engineName+
"\x3c/b\x3e\x3cbr /\x3e"}))))})));this._requestCompleteQueued&&(this._requestCompleteQueued=!1,this.FMERestManager.getQueuedJobs().then(f.hitch(this,function(b){b&&(b.data||b.items)&&(b=b.data||b.items);b&&b.message&&b.message.contains("Unauthorized request")?(clearInterval(this._statusInterval),this.destroy()):(m.show(this.domNode),this._requestCompleteQueued=!0,0===b.length?(this._queuedTitle.innerHTML=this.nls.Status.QueuedJobs+" (0)",this._queued.innerHTML=this.nls.Status.NoQueuedJobs):(this._queuedTitle.innerHTML=
this.nls.Status.QueuedJobs+" ("+b.length+")",this._queued.innerHTML="",a.forEach(b,f.hitch(this,function(a){this._queued.innerHTML+=a.id+", "+a.request.workspacePath.split("/")[1]+" \x3cb\x3e"+a.engineName+"\x3c/b\x3e\x3cbr /\x3e"}))))})))},destroy:function(){this.inherited(arguments)}})})},"app/FMEPortal/Toolbar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/event dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/text!./templates/toolbar.html dojo/topic ./Utils ./Toolbar/Buffer dojo/i18n!./nls/resources esri/toolbars/draw esri/toolbars/edit esri/layers/GraphicsLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color esri/graphic esri/geometry/Polygon esri/geometry/Extent esri/geometry/webMercatorUtils esri/tasks/AreasAndLengthsParameters esri/tasks/BufferParameters esri/tasks/GeometryService esri/config dijit/Menu dijit/form/Button dijit/form/NumberTextBox dijit/form/Form dijit/form/CheckBox dijit/Fieldset".split(" "),
function(l,c,f,a,b,g,d,k,h,p,q,m,v,n,y,u,A,w,C,z,x,D,r,I,F,G,H,E,B,J){return l("FmePortal-Toolbar",[b,g,d,k],{templateString:p,widgetsInTemplate:!0,baseClass:"fmeportal-toolbar",_activeColor:null,_bufferColor:null,constructor:function(a){this.options=a;this.nls=n;this._activeColor=this.options.settings.map.drawColor;this._bufferColor=this.options.settings.map.bufferColor;B.defaults.geometryService=new E(this.options.settings.map.geometryService);this._toolbar=new y(this.options.map);this._editor=
new u(this.options.map);this.own(h(this._toolbar,"draw-end",c.hitch(this,this._addToMap)),h(this._editor,"deactivate",c.hitch(this,function(a){this._refreshArea(a.graphic.geometry);this._setGeometryParameter(a.graphic.geometry)})),h(this._editor,"activate",c.hitch(this,function(a){this._drawnArea.innerHTML=this.nls.Toolbar.Edit})));this._createBufferLayer();this._createDrawLayer();this._createGraphicsToolsMenu();this._addTopics()},_createBufferLayer:function(){this._bufferGraphicsLayer=new A;this.options.map.addLayer(this._bufferGraphicsLayer)},
_createDrawLayer:function(){this._drawGraphicsLayer=new A;this.options.map.addLayer(this._drawGraphicsLayer);this.own(h(this._drawGraphicsLayer,"mouse-over",c.hitch(this,function(a){this._selectedGraphic=a.graphic;this._graphicToolsMenu.bindDomNode(a.graphic.getDojoShape().getNode())})),h(this._drawGraphicsLayer,"mouse-out",c.hitch(this,function(a){this._graphicToolsMenu.unBindDomNode(a.graphic.getDojoShape().getNode())})),h(this._drawGraphicsLayer,"click",c.hitch(this,function(a){this._drawingEnabled||
(f.stop(a),this._editingEnabled?(this._editingEnabled=!1,this._editor.deactivate()):(this._editor.activate(u.MOVE|u.SCALE|u.EDIT_VERTICES|u.ROTATE|u.EDIT_TEXT,a.graphic),this._editingEnabled=!0))})),h(this.options.map,"click",c.hitch(this,function(){this._editingEnabled&&(this._editingEnabled=!1,this._editor.deactivate())})))},_addTopics:function(){q.subscribe("FMEPortal/buffer",c.hitch(this,function(a){if(0===this._bufferGraphicsLayer.graphics.length){var b=new z;b.setColor(new x(this._bufferColor));
this._bufferGraphicsLayer.add(new D(this._drawGraphicsLayer.graphics[0].geometry,b))}b=new H;b.distances=[a];b.outSpatialReference=this.options.map.spatialReference;b.unit=E.UNIT_METER;b.unionResults=!0;b.geometries=[this._bufferGraphicsLayer.graphics[0].geometry];B.defaults.geometryService.buffer(b,c.hitch(this,function(a){this._drawGraphicsLayer.clear();this._addToMap({geometry:a[0]})}))}));q.subscribe("FMEPortal/showGeometryTools",c.hitch(this,function(){m.show(this._geometryTools);m.hide(this._noTools)}));
q.subscribe("FMEPortal/hideGeometryTools",c.hitch(this,function(){m.hide(this._geometryTools);m.show(this._noTools)}))},_addToMap:function(a){var b,e;this._drawMulti.get("checked")||this._toolbar.deactivate();switch(a.geometry.type){case "point":case "multipoint":e=a.geometry;b=new w;b.setColor(new x(this._activeColor));break;case "polyline":e=a.geometry;b=new C;b.setWidth(5);b.setColor(new x(this._activeColor));break;case "polygon":e=a.geometry;b=new z;b.setColor(new x(this._activeColor));break;
case "extent":e=a.geometry,b=new z,b.setColor(new x(this._activeColor)),a=new r(this.options.map.spatialReference),a.addRing([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]),e=a}if(this._drawMulti.get("checked")&&0<this._drawGraphicsLayer.graphics.length){var d=this._drawGraphicsLayer.graphics[0];B.defaults.geometryService.intersect([d.geometry],e).then(c.hitch(this,function(a){0===a[0].rings.length?(d.geometry.addRing(e.rings[0]),e=d.geometry,this._drawGraphicsLayer.redraw(),
this._refreshArea(e),this._setGeometryParameter(e)):alert(this.nls.Toolbar.HasIntersections);this._drawingEnabled=!1}))}else b=new D(e,b),this._drawGraphicsLayer.add(b),this._refreshArea(e),this._setGeometryParameter(e),this._drawingEnabled=!1},_refreshArea:function(a){var b=new G;b.lengthUnit=B.defaults.geometryService.UNIT_METERS;b.areaUnit=B.defaults.geometryService.UNIT_SQUARE_METERS;b.calculationType="preserveShape";b.polygons=[a];B.defaults.geometryService.areasAndLengths(b).then(c.hitch(this,
function(a){this._drawnArea.innerHTML=c.replace(this.nls.Toolbar.Area,{area:"\x3cb\x3e"+(a.areas[0]/1E4).toLocaleString()+"\x3c/b\x3e"})}));this._xmin.set("value",Math.round(a.getExtent().xmin));this._ymin.set("value",Math.round(a.getExtent().ymin));this._xmax.set("value",Math.round(a.getExtent().xmax));this._ymax.set("value",Math.round(a.getExtent().ymax))},_setGeometryParameter:function(a){var b;if("esrijson"===this.options.settings.fme.geometry.format)b=JSON.stringify(a.toJson()),this.emit("geometry-change",
b);else if("geojson"===this.options.settings.fme.geometry.format){a=F.webMercatorToGeographic(a);var c=1<a.rings.length;b=c?"MULTIPOLYGON (":"POLYGON (";a.rings.forEach(function(a){b+=c?"((":"(";for(var e=0;e<a.length;e++)b+=a[e][0]+" "+a[e][1]+",";b=b.substr(0,b.length-1);b+=c?")),":"),"});b=b.substr(0,b.length-1)+")";this.emit("geometry-change",b)}},postCreate:function(){this.inherited(arguments);this.own(h(this._drawPolygon,"click",c.hitch(this,function(){this._startDrawing("POLYGON")})),h(this._drawExtent,
"click",c.hitch(this,function(){this._startDrawing("EXTENT")})),h(this._drawMulti,"change",c.hitch(this,function(){this._toolbar.deactivate();this._editor.deactivate()})),h(this._clearMap,"click",c.hitch(this,function(){this._xmin.set("value",0);this._ymin.set("value",0);this._xmax.set("value",0);this._ymax.set("value",0);this._drawGraphicsLayer.clear();this._bufferGraphicsLayer.clear();this._jsonGeometry=null;this._drawnArea.innerHTML="";this._toolbar.deactivate();this._editor.deactivate();this.emit("geometry-change")})),
h(this._inputExtent,"click",c.hitch(this,function(){m.toggle(this._inputExtentArea.domNode);this._inputExtentArea.resize()})),h(this._drawInputExtent,"click",c.hitch(this,function(){if(this._inputForm.validate()){var a=this._xmin.get("value"),b=this._ymin.get("value"),c=this._xmax.get("value"),d=this._ymax.get("value");a&&b&&c&&d&&a<c&&b<d?(this._drawGraphicsLayer.clear(),this._bufferGraphicsLayer.clear(),a=new I({xmin:a,ymin:b,xmax:c,ymax:d,spatialReference:this.options.map.spatialReference}),this._addToMap({geometry:a}),
this.options.map.setExtent(a.expand(1.2),!0)):q.publish("FMEPortal/alert",this.nls.Toolbar.InputExtent.Title,this.nls.Toolbar.InputExtent.InvalidCoordinates)}else q.publish("FMEPortal/alert",this.nls.Toolbar.InputExtent.Title,this.nls.Toolbar.InputExtent.InvalidCoordinates)})))},_startDrawing:function(a){this._xmin.set("value",0);this._ymin.set("value",0);this._xmax.set("value",0);this._ymax.set("value",0);this._drawMulti.get("checked")||(this._drawGraphicsLayer.clear(),this._bufferGraphicsLayer.clear());
this._toolbar.activate(y[a]);this._drawingEnabled=!0},_createGraphicsToolsMenu:function(){this._graphicToolsMenu=new J({});var a=new v({label:this.nls.Toolbar.Buffer.SetBuffer});this._graphicToolsMenu.addChild(a);this._graphicToolsMenu.startup()},destroy:function(){this.inherited(arguments)}})})},"app/FMEPortal/Toolbar/Buffer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dijit/PopupMenuItem dijit/TooltipDialog ./BufferInput".split(" "),function(l,c,f,a,b,g){return l(a,{constructor:function(a){a=
a||{};c.mixin(this,a)},postCreate:function(){this.inherited(arguments);var a=new g;this.popup=new b({style:"width:200px;",content:a});f.set(this.popup.connectorNode,"display","none");this.popup.startup()}})})},"app/FMEPortal/Toolbar/BufferInput":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!../templates/buffer.html dojo/i18n!../nls/resources dojo/topic dijit/form/NumberTextBox dijit/form/Button".split(" "),
function(l,c,f,a,b,g,d,k,h){return l("FmePortal-Buffer-Input",[f,a,b,g],{templateString:d,widgetsInTemplate:!0,options:{},constructor:function(a){this.options=c.mixin(this.options,a);this.nls=k},postCreate:function(){this._setBuffer.on("click",c.hitch(this,function(){(0>this._bufferVal.get("value")||0<this._bufferVal.get("value"))&&h.publish("FMEPortal/buffer",this._bufferVal.get("value"))}))},destroy:function(){this.inherited(arguments)}})})},"url:app/FMEPortal/templates/wrapper.html":'\x3cdiv\x3e\r\n    \x3ch2\x3e${options.settings.fme.general.title}\x3c/h2\x3e\r\n    \x3cdiv class\x3d"${baseClass}-about" data-dojo-attach-point\x3d"_about"\x3e\r\n        \x3ci class\x3d"material-icons"\x3e\x26#xE88E;\x3c/i\x3e ${nls.Widget.About}\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_loginWrapper"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_loginStatus"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_stepOne" style\x3d"display:none;"\x3e\r\n        \x3ch3\x3e${nls.Widget.Step1.Title}\x3c/h3\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_toolbar"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_stepTwo" style\x3d"display:none;"\x3e\r\n        \x3ch3\x3e${nls.Widget.Step2.Title}\x3c/h3\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_repositorySelector" style\x3d"display:none;"\x3e\x3cdiv\x3e${nls.Widget.Step2.Repository}\x3c/div\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_workspaceSelector" style\x3d"display:none;"\x3e\x3cdiv\x3e${nls.Widget.Step2.Workspace}\x3c/div\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_formContent"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_loadingParams" class\x3d"${baseClass}-loading"\x3e\r\n                \x3cimg src\x3d"${loaderAnim}" /\x3e ${nls.Widget.Step2.LoadingParams}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_loadingContent" class\x3d"${baseClass}-loading"\x3e\r\n            \x3cimg src\x3d"${loaderAnim}" /\x3e${nls.Widget.Step2.LoadingContent}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_stepThree" style\x3d"display:none;"\x3e\r\n        \x3ch3\x3e${nls.Widget.Step3.Title}\x3c/h3\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_resultLoading" class\x3d"${baseClass}-loading"\x3e\r\n            \x3cimg src\x3d"${loaderAnim}" /\x3e ${nls.Widget.Step3.LoadingResult}\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_resetResultCount" style\x3d"display:none;" class\x3d"${baseClass}-result-clear"\x3e\r\n            \x3ci class\x3d"material-icons" style\x3d"vertical-align:middle;font-size: 20px;"\x3e\x26#xE872;\x3c/i\x3e ${nls.Widget.Step3.ClearResult}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${baseClass}-results" data-dojo-attach-point\x3d"_resultView"\x3e\r\n            \r\n        \x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_noResults"\x3e${nls.Widget.Step3.NoTranslationResults}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:app/FMEPortal/templates/login.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/TabContainer" data-dojo-props\x3d"controllerWidget: \'dijit.layout.TabController\', doLayout:false" data-dojo-attach-point\x3d"_tabContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"label: \'${nls.Login.Tabs.Credentials.Title}\', title: \'${nls.Login.Tabs.Credentials.Title}\'"\x3e\r\n            \x3cspan\x3e${nls.Login.Tabs.Credentials.Info}\x3c/span\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_fmeLoginForm"\x3e\r\n                \x3cbr /\x3e\r\n                \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e${nls.Login.Tabs.Credentials.Username}:\x3c/td\x3e\r\n                        \x3ctd\x3e\x3cdiv data-dojo-type\x3d"dijit/form/ValidationTextBox" name\x3d"username" required\x3d"true" data-dojo-attach-point\x3d"_fmeUsername"\x3e\x3c/div\x3e\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e${nls.Login.Tabs.Credentials.Password}:\x3c/td\x3e\r\n                        \x3ctd\x3e\x3cdiv data-dojo-type\x3d"dijit/form/ValidationTextBox" name\x3d"password" required\x3d"true" data-dojo-props\x3d"type:\'password\'" data-dojo-attach-point\x3d"_fmePassword"\x3e\x3c/div\x3e\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                \x3c/table\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_login"\x3e${nls.Login.Button}\x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_loginStatus"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_tokenTab" data-dojo-props\x3d"label: \'${nls.Login.Tabs.Token.Title}\', title: \'${nls.Login.Tabs.Token.Title}\'"\x3e\r\n            \x3cspan\x3e${nls.Login.Tabs.Token.Info}\x3c/span\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_fmeTokenForm"\x3e\r\n                \x3cbr /\x3e\r\n                \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e${nls.Login.Tabs.Token.Token}:\x3c/td\x3e\r\n                        \x3ctd\x3e\x3cdiv data-dojo-type\x3d"dijit/form/ValidationTextBox" name\x3d"token" required\x3d"true" data-dojo-attach-point\x3d"_fmeToken" data-dojo-props\x3d"value: \'${options.settings.fme.server.token.token}\'"\x3e\x3c/div\x3e\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                \x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_tokenLogin"\x3e${nls.Login.Button}\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_tokenStatus"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_settingsTab" data-dojo-props\x3d"label: \'${nls.Login.Tabs.Settings.Title}\', title: \'${nls.Login.Tabs.Settings.Title}\'"\x3e\r\n            \x3cspan\x3e${nls.Login.Tabs.Settings.Info}\x3c/span\x3e\r\n            \x3cbr /\x3e\r\n            \x3ctable\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e${nls.Login.Tabs.Settings.ServerUrl}:\x3c/td\x3e\r\n                    \x3ctd\x3e\x3cdiv data-dojo-type\x3d"dijit/form/ValidationTextBox" required\x3d"true" data-dojo-props\x3d"value: \'${options.settings.fme.server.url}\'" data-dojo-attach-point\x3d"_serverUrl"\x3e\x3c/div\x3e\x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e${nls.Login.Tabs.Settings.AdminMode.Info}\x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e${nls.Login.Tabs.Settings.AdminMode.Label}:\x3c/td\x3e\r\n                    \x3ctd\x3e\x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_adminMode" /\x3e\x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:app/FMEPortal/templates/workspace-info.html":'\x3cdiv\x3e\r\n    \x3ch3\x3e${options.name}\x3c/h3\x3e\r\n    \x3ctable class\x3d"${baseClass}-infotable"\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Title}\x3c/td\x3e\r\n            \x3ctd\x3e${options.title}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Build}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.buildNumber}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Filesize}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.fileSize}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Category}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.category}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Description}:\x3c/td\x3e\r\n            \x3ctd\x3e${!options.description}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.History}:\x3c/td\x3e\r\n            \x3ctd\x3e${!options.history}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.LastSaveBuild}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.lastSaveBuild}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.LastSaveDate}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.lastSaveDate}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Resources}:\x3c/td\x3e\r\n            \x3ctd\x3e${!options.resources}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Services}:\x3c/td\x3e\r\n            \x3ctd\x3e${!options.services}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Type}:\x3c/td\x3e\r\n            \x3ctd\x3e${options.type}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd\x3e${nls.WorkspaceInfo.Usage}:\x3c/td\x3e\r\n            \x3ctd\x3e${!options.usage}\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e',
"url:app/FMEPortal/templates/workspace-form.html":'\x3cdiv\x3e\r\n    \x3ch4 data-dojo-attach-point\x3d"_title"\x3e${!title}\x3c/h4\x3e\r\n    \x3cdiv class\x3d"fmeportal-help" style\x3d"display:none" data-dojo-attach-point\x3d"_description"\x3e${!description}\x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/Form" class\x3d"fmeportal-form" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cul data-dojo-attach-point\x3d"_formList"\x3e\x3c/ul\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_serviceModeContainer"\x3e\r\n            \x3clabel\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_serviceMode" /\x3e ${nls.GenerateForms.EmailResults}\r\n            \x3c/label\x3e\r\n            \x3cinput style\x3d"display:none;" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"_email" data-dojo-props\x3d"regExp: dojox.validate.regexp.emailAddress, placeholder: \'${nls.GenerateForms.EmailPlaceholder}\'" /\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"fmeportal-orderbutton" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_order"\x3e${nls.GenerateForms.ButtonOrder}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_serviceType" style\x3d"display:none;float:right;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:app/FMEPortal/templates/result.html":'\x3cdiv class\x3d"fmeportal-result fmeportal-{resultClass}"\x3e\r\n    \x3cdiv\x3e\x3ci class\x3d\'material-icons\'\x3e{icon}\x3c/i\x3e {date}\x3c/div\x3e\r\n    \x3cdiv class\x3d"fmeportal-result-ws"\x3e{workspace}\x3c/div\x3e\r\n    \x3cdiv\x3e{message}\x3c/div\x3e\r\n\x3c/div\x3e',"url:app/FMEPortal/templates/file-upload.html":'\x3cdiv\x3e\r\n    \x3cfieldset\x3e\r\n        \x3clegend\x3e${nls.FileUpload.AddFiles} \x3cb\x3e${description}\x3c/b\x3e\x3c/legend\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_uploader" name\x3d"uploadedfile" multiple\x3d"true" type\x3d"file" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-props\x3d"label: \'${nls.FileUpload.SelectFiles}\'"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_fileUrl" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_urlFilelist"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_fileContainer" style\x3d"display:none;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_fileList"\x3e\x3c/div\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_submit" type\x3d"button" label\x3d"${nls.FileUpload.Button}" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_uploading" style\x3d"display:none;"\x3e\r\n                \x3cimg src\x3d"${loaderAnim}" /\x3e ${nls.FileUpload.Uploading}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_uploadedContainer" style\x3d"display:none;"\x3e\r\n            \x3ch3\x3e${nls.FileUpload.SelectTranslationFiles}\x3c/h3\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_uploadedFiles" class\x3d"fmeportal-uploadedFiles"\x3e${nls.FileUpload.NoFiles}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n\x3c/div\x3e\r\n',
"url:app/FMEPortal/templates/status.html":'\x3cdiv class\x3d"fmeportal-status"\x3e\r\n    \x3ch3\x3e${nls.Status.Title}\x3c/h3\x3e\r\n    \x3ch4 data-dojo-attach-point\x3d"_runningTitle"\x3e${nls.Status.RunningJobs}\x3c/h4\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_running"\x3e\x3c/div\x3e\r\n    \x3ch4 data-dojo-attach-point\x3d"_queuedTitle"\x3e${nls.Status.QueuedJobs}\x3c/h4\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_queued"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:app/FMEPortal/css/styles.css":{cssText:".fmeportal h2{font-size:200%;}.fmeportal h3{padding:5px;margin-left:-10px;margin-right:-10px;}.fmeportal h4{display:block;margin-top:10px;margin-bottom:0;font-size:115%;cursor:pointer;}.fmeportal h4 .material-icons{vertical-align:middle;}.fmeportal-loading{display:none;margin:5px;font-weight:bold;}.fmeportal-result .material-icons{vertical-align:middle;}.fmeportal-result-clear{position:absolute;right:20px;margin-top:-25px;color:gray;cursor:pointer;}.fmeportal-about{cursor:pointer;position:absolute;top:30px;right:20px;}.fmeportal-result-ws{font-weight:normal;}.fmeportal-error{color:#505050;padding:5px;background:#e5e5e5;margin-bottom:5px;-moz-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.75);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.5);}.fmeportal-error i, .fmeportal-error a{color:red;}.fmeportal-success{color:#505050;padding:5px;background:#e5e5e5;margin-bottom:5px;-moz-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.75);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.5);}.fmeportal-success i, .fmeportal-success a{color:#1a70a6;text-decoration:none;}.fmeportal-disabled{opacity:0.4;}.fmeportal fieldset{width:335px;border:1px solid #dcebf5;margin:0;}.fmeportal-denied{padding:15px;font-size:110%;color:#a41616;font-weight:bold;}.fmeportal-help{padding:5px;margin-top:10px;background:#dceffa;color:black;}.fmeportal-infotable{border-collapse:collapse;}.fmeportal-infotable, .fmeportal-infotable td{border:1px solid #d7d5d5;padding:8px;}.fmeportal-infotable tr:first-child{width:200px;}.fmeportal-form ul{list-style-type:none;padding:0 10px;}.fmeportal-form li{margin:5px 0;min-height:30px;}.fmeportal-formitem \x3e div{display:inline-block;vertical-align:top;}.fmeportal-caption{width:145px;padding-right:5px;}.fmeportal-uploadedFiles label{display:block;margin:3px;word-break:break-all;}.fmeportal-status{position:absolute;top:10px;right:10px;background:#fff;z-index:10;width:400px;box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);padding:20px;}.fmeportal-area{display:block;font-size:120%;margin:5px;}.fmeportal-toolbar .material-icons{color:#4c4c4c;}.fmeportal-orderbutton .dijitButtonNode{font-size:120%;width:100px;}.fmeportal .dojoxCheckedMultiSelectWrapper{border:0 !important;}.fmeportal .dijitButtonContents{outline:none;}.fmeportal .material-icons{vertical-align:middle;cursor:pointer;}.fmeportal .dijitTabContainer .dijitDisabled{display:none;}.fmeportal .dojoxColorPicker{background:#f5f5f5;padding:10px;border:1px solid #d8d8d8;}.fmeportal .dojoxUploaderFileName{word-break:break-all;}",
xCss:".fmeportal-infotable tr:first-childwidth\x3d;;font-size\x3d;margin-right\x3d;cursor\x3d;vertical-align\x3d;font-weight\x3d;vertical-align\x3d;right\x3d;font-weight\x3d;{/9-moz-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.75);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.5);box-shadow\x3d;}color\x3d;{/11-moz-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.75);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.5);box-shadow\x3d;}text-decoration\x3d;opacity\x3d;margin\x3d;font-weight\x3d;color\x3d;border-collapse\x3d;padding\x3d;width\x3d;padding\x3d;min-height\x3d;vertical-align\x3d;padding-right\x3d;word-break\x3d;{/25box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);padding\x3d;}margin\x3d;color\x3d;width\x3d;border\x3d;outline\x3d;cursor\x3d;display\x3d;border\x3d;word-break\x3d;"},
"url:app/FMEPortal/templates/toolbar.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_geometryTools" style\x3d"display:none;"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_drawPolygon"\x3e\x3ci class\x3d"material-icons"\x3e\x26#xE3C9;\x3c/i\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_drawExtent"\x3e\x3ci class\x3d"material-icons"\x3e\x26#xE25E;\x3c/i\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_clearMap"\x3e\x3ci class\x3d"material-icons"\x3e\x26#xE872;\x3c/i\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_inputExtent"\x3e\x3ci class\x3d"material-icons"\x3e\x26#xE56B;\x3c/i\x3e ${nls.Toolbar.Coordinates}\x3c/div\x3e\r\n        \x3clabel style\x3d"margin:5px; display:block;"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_drawMulti" /\x3e ${nls.Toolbar.DrawMultiple}\r\n        \x3c/label\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_drawnArea"\x3e\x3c/div\x3e\r\n        \x3cfieldset data-dojo-attach-point\x3d"_inputExtentArea" class\x3d\'smart-fme-inputextent\' data-dojo-type\x3d"dijit/Fieldset" data-dojo-props\x3d"toggleable:false, style:\'margin-top: 15px; display:none;\'"\x3e\r\n            \x3clegend\x3e${nls.Toolbar.InputExtent.Title}:\x3c/legend\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_inputForm"\x3e\r\n                \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                            ${nls.Toolbar.InputExtent.xmin}:\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            \x3cdiv data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"_xmin" data-dojo-props\x3d"value: 0, invalidMessage: \'${nls.Toolbar.InputExtent.Validation.Coordinates}\', placeholder: \'${nls.Toolbar.InputExtent.Input} ${nls.Toolbar.InputExtent.xmin}\', style: \'width:110px\'"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            ${nls.Toolbar.InputExtent.xmax}:\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            \x3cdiv data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"_xmax" data-dojo-props\x3d"value: 0, invalidMessage: \'${nls.Toolbar.InputExtent.Validation.Coordinates}\', placeholder: \'${nls.Toolbar.InputExtent.Input} ${nls.Toolbar.InputExtent.xmax}\', style: \'width:110px\'"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                            ${nls.Toolbar.InputExtent.ymin}:\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            \x3cdiv data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"_ymin" data-dojo-props\x3d"value: 0, invalidMessage: \'${nls.Toolbar.InputExtent.Validation.Coordinates}\', placeholder: \'${nls.Toolbar.InputExtent.Input} ${nls.Toolbar.InputExtent.ymin}\', style: \'width:110px\'"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            ${nls.Toolbar.InputExtent.ymax}:\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            \x3cdiv data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"_ymax" data-dojo-props\x3d"value: 0, invalidMessage: \'${nls.Toolbar.InputExtent.Validation.Coordinates}\', placeholder: \'${nls.Toolbar.InputExtent.Input} ${nls.Toolbar.InputExtent.ymax}\', style: \'width:110px\'"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                \x3c/table\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"style:\'float: right;margin-right: 15px;\'" data-dojo-attach-point\x3d"_drawInputExtent"\x3e${nls.Toolbar.InputExtent.ButtonDraw}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_noTools"\x3e\r\n        ${nls.Toolbar.Message}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:app/FMEPortal/templates/buffer.html":'\x3cdiv\x3e\r\n    \x3cdiv style\x3d"display:inline-block;width:75px;" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"value: 0" data-dojo-attach-point\x3d"_bufferVal"\x3e\r\n        \r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"display:inline-block" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_setBuffer"\x3e\r\n        ${nls.Toolbar.Buffer.UseBuffer}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',"*now":function(l){l(['dojo/i18n!*preload*app/nls/FMEPortal*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","th","tr","zh-tw","zh-cn"]'])},
"*noref":1}});
define("app/FMEPortal","require dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/Deferred dojo/promise/all dojo/text!./FMEPortal/templates/wrapper.html dojo/dom-construct dojo/topic dojo/Stateful dijit/registry dijit/form/Select dijit/form/Button dijit/Dialog dojo/data/ObjectStore dojo/store/Memory ./FMEPortal/RestManager ./FMEPortal/Utils ./FMEPortal/Login ./FMEPortal/WorkspaceInfo ./FMEPortal/GenerateForms ./FMEPortal/Status dojo/i18n!./FMEPortal/nls/resources xstyle/css!./FMEPortal/css/styles.css".split(" "),function(l,
c,f,a,b,g,d,k,h,p,q,m,v,n,y,u,A,w,C,z,x,D,r,I,F,G,H,E){return c("FmePortal-Widget",[b,g,d,k,y],{templateString:m,widgetsInTemplate:!0,baseClass:"fmeportal",_eventHandles:[],_resultCount:0,constructor:function(a){this.FMERestManager=new D(a);this.options=a;this.nls=E;this.loaderAnim=l.toUrl("./FMEPortal/images/loader.gif");String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)};String.prototype.contains=function(a){return-1!==this.indexOf(a)};this._addTopics()},_addTopics:function(){n.subscribe("FMEPortal/orderStart",
f.hitch(this,function(){r.show(this._resultLoading)}));n.subscribe("FMEPortal/orderComplete",f.hitch(this,function(a){r.hide(this._resultLoading);this.set("_resultCount",this.get("_resultCount")+1);v.place(a,this._resultView,"first")}));n.subscribe("FMEPortal/showLogin",f.hitch(this,function(){n.publish("FMEPortal/alert",this.options.settings.fme.general.title,this.nls.Login.Messages.Expired);r.hide(this._loadingParams);this._resultView.innerHTML="";this._removeExistingToken();this._logoutButton.destroy();
this._loginStatus.innerHTML="";this._showLogin()}));n.subscribe("FMEPortal/alert",f.hitch(this,function(a,b){var c=new C({title:a,content:b,autofocus:!1,hide:function(){c.destroy()}});c.show()}))},postCreate:function(){this.inherited(arguments);var a=this._getExistingToken();a&&a.token&&a.server?(this.options.settings.fme.server.adminMode=a.adminMode,this.options.settings.fme.server.url=a.server,this.FMERestManager.init({server:this.options.settings.fme.server.url,token:a.token}),this._testExistingToken().then(f.hitch(this,
function(b){b?(this._updateLoginStatus(a.username),this._startFmePortal(this.options.settings.fme.server.adminMode)):this._showLogin()}))):this.options.settings.fme.server.token.autoLogin?(this.FMERestManager.init({server:this.options.settings.fme.server.url,token:this.options.settings.fme.server.token.token||"12345"}),this._testExistingToken().then(f.hitch(this,function(a){a?this._startFmePortal(this.options.settings.fme.server.adminMode):this._showLogin()}))):(this.FMERestManager.init({server:this.options.settings.fme.server.url,
token:"111"}),this._showLogin());this.watch("_resultCount",f.hitch(this,function(a,b,c){0<c?(r.show(this._resetResultCount),r.hide(this._noResults)):(r.hide(this._resetResultCount),r.show(this._noResults))}));this.own(h(this._resetResultCount,"click",f.hitch(this,function(){this.set("_resultCount",0);this._resultView.innerHTML=""})),h(this._about,"click",f.hitch(this,function(){n.publish("FMEPortal/alert",this.nls.Widget.About+" "+this.options.settings.fme.general.title,this.options.settings.fme.general.about)})))},
_showLogin:function(){var a=(new I(this.options)).placeAt(this._loginWrapper,"first");a.startup();a.on("login",f.hitch(this,function(b,c){f.mixin(this.options.settings.fme.server,c);this.FMERestManager.init({server:this.options.settings.fme.server.url,token:"111"});this.FMERestManager.generateToken(encodeURIComponent(b.username),encodeURIComponent(b.password),this.options.settings.fme.server.token.time,this.options.settings.fme.server.token.unit).then(f.hitch(this,function(c){c.contains("Authentication failed")?
a.setLoginStatus(this.nls.Login.Messages.BadLogin):""===c?a.setLoginStatus(f.replace(this.nls.Login.Messages.NoAccess,{url:this.options.settings.fme.server.url})):c.contains("Both user ID and password need to be specified")?a.setLoginStatus(this.nls.Login.Messages.BadLogin):(a.destroy(),this._updateLoginStatus(b.username),this.FMERestManager.init({server:this.options.settings.fme.server.url,token:c}),this._saveToken(c,b.username),this._startFmePortal(this.options.settings.fme.server.adminMode))}))}));
a.on("tokenLogin",f.hitch(this,function(b,c){f.mixin(this.options.settings.fme.server,c);this.FMERestManager.init({server:this.options.settings.fme.server.url,token:b.token});this._testExistingToken().then(f.hitch(this,function(c){c?(a.destroy(),this._updateLoginStatus(),this._saveToken(b.token,"token-user"),this._startFmePortal(this.options.settings.fme.server.adminMode)):a.setTokenStatus(this.nls.Login.Messages.BadToken)}))}))},_updateLoginStatus:function(a){this._loginStatus.innerHTML=a?this.nls.Login.SignedInAs+
" \x3cb\x3e"+a+"\x3c/b\x3e. ":this.nls.Login.TokenSignIn+". ";this._logoutButton=(new w({label:this.nls.Login.ButtonSignout,onClick:f.hitch(this,function(){this._removeExistingToken();this._logoutButton.destroy();this._loginStatus.innerHTML="";this._showLogin()})})).placeAt(this._loginStatus,"last")},_saveToken:function(a,b){localStorage.setItem("fmeportal-"+this.options.settings.fme.general.id+"-token",JSON.stringify({token:a,username:b,server:this.options.settings.fme.server.url,adminMode:this.options.settings.fme.server.adminMode}))},
_getExistingToken:function(){var a=localStorage.getItem("fmeportal-"+this.options.settings.fme.general.id+"-token");try{return a?JSON.parse(a):null}catch(J){return null}},_removeExistingToken:function(){this.FMERestManager.init({server:this.options.settings.fme.server.url,token:"12345"});a.forEach([this._stepOne,this._stepTwo,this._stepThree,this._workspaceSelector,this._repositorySelector],function(a){r.hide(a)});this._rsSelect?this._rsSelect.destroy():null;this._wsSelect?this._wsSelect.destroy():
null;this._activeForm?this._activeForm.destroy():null;localStorage.removeItem("fmeportal-"+this.options.settings.fme.general.id+"-token")},_testExistingToken:function(){var a=new p;this.FMERestManager.getInfo().then(f.hitch(this,function(b){b&&b.data&&b.data.message&&b.data.message.contains("Authentication failed")||""===b?a.resolve(!1):a.resolve(!0)}));return a},_startFmePortal:function(b){u.byId("fmeportal-details")&&u.byId("fmeportal-details").destroy();a.forEach([this._stepOne,this._stepTwo,this._stepThree],
function(a){r.show(a)});this.options.map?l(["./FMEPortal/Toolbar"],f.hitch(this,function(a){this._activeToolbar&&this._activeToolbar.destroy();this._activeToolbar=(new a(this.options)).placeAt(this._toolbar);this.own(h(this._activeToolbar,"geometry-change",f.hitch(this,function(a){this._activeGeometry=a;this._activeForm&&this._activeForm.setGeometry(this._activeGeometry)})))})):this._toolbar.innerHTML=this.nls.Toolbar.NoMap;a.forEach(this._eventHandles,function(a){a.remove()});b?(r.show(this._loadingContent),
this.FMERestManager.getRepositories().then(f.hitch(this,this._adminModeSelects))):this.FMERestManager.getRepositories().then(f.hitch(this,this._userModeSelects));this._portalStatus=(new H({settings:this.options,restManager:this.FMERestManager})).placeAt(this.options.map?this.options.map.root:this.domNode,"last")},_adminModeSelects:function(b){if(b&&b.items&&0<b.items.length){var c=[],d=[],g=[];a.forEach(b.items,f.hitch(this,function(b){var e=new p;g.push(e);d.push({id:b.name,label:b.name});this.FMERestManager.getWorkspacesForRepository(b.name).then(function(d){a.forEach(d.items,
function(a){c.push({id:a.name,label:a.name,repo:b.name})});e.resolve()})}));q(g).then(f.hitch(this,function(){this._wsSelect&&this._wsSelect.destroy();this._wsSelect=(new A({store:new z({objectStore:new x({data:c})}),style:"width:250px;"})).placeAt(this._workspaceSelector,"last");r.show(this._workspaceSelector);this._wsSelect.startup();this._wsSelect.set("query",{repo:d[0].id});this._rsSelect&&this._rsSelect.destroy();this._rsSelect=(new A({store:new z({objectStore:new x({data:d})}),style:"width:250px;"})).placeAt(this._repositorySelector,
"last");r.show(this._repositorySelector);this._rsSelect.startup();this._eventHandles.push(this._rsSelect.on("change",f.hitch(this,function(){var a=this._rsSelect.get("value");this._wsSelect.set("query",{repo:a});var b=this._wsSelect.get("value");this._buildFmeForm({repo:a,id:b})})));this._eventHandles.push(this._wsSelect.on("change",f.hitch(this,function(){var a=this._rsSelect.get("value"),b=this._wsSelect.get("value");this._buildFmeForm({repo:a,id:b})})));r.hide(this._loadingContent)}))}else r.hide(this._loadingContent),
n.publish("FMEPortal/alert",this.options.settings.fme.general.title,this.nls.Login.Messages.NoPermission)},_userModeSelects:function(b){var c=[];a.forEach(b.items,function(a){c.push(a.name)});var d=[];d.push({id:-1,label:"-- "+this.nls.Widget.Step2.ChooseWorkspace+" -- ",disabled:!0});a.forEach(this.options.settings.fme.includedWorkspaces,function(a){d.push({id:a.workspace,label:a.title,repo:a.repository,description:a.description,service:a.service,permission:-1!==c.indexOf(a.repository)})});this._wsSelect&&
this._wsSelect.destroy();this._wsSelect=(new A({store:new z({objectStore:new x({data:d})}),style:"width:250px;"})).placeAt(this._workspaceSelector,"last");r.show(this._workspaceSelector);this._wsSelect.startup();this._eventHandles.push(this._wsSelect.on("change",f.hitch(this,function(){this._wsSelect.set("disabled",!0);var a=this._wsSelect.get("store"),b=this._wsSelect.get("value");this._permissionMessage?v.destroy(this._permissionMessage):null;-1!==b?a.get(b).then(f.hitch(this,function(a){a.permission?
this._buildFmeForm(a):(this._activeForm?this._activeForm.destroy():null,this._permissionMessage=v.create("div",{"class":"fmeportal-denied",innerHTML:this.nls.Login.Messages.NoWorkspacePermission}),v.place(this._permissionMessage,this._formContent,"last"),this._wsSelect.set("disabled",!1))})):(n.publish("FMEPortal/hideGeometryTools"),this._activeForm?this._activeForm.destroy():null,this._activeForm=null,this._wsSelect.set("disabled",!1))})))},_buildFmeForm:function(b){n.publish("FMEPortal/hideGeometryTools");
this._activeForm&&this._activeForm.destroy();r.show(this._loadingParams);this.FMERestManager.getWorkspaceParameters(b.repo,b.id).then(f.hitch(this,function(c){c&&"Authentication failed: Failed to login"===c.message?(n.publish("FMEPortal/alert",this.options.settings.fme.general.title,this.nls.Login.Messages.Expired),this._removeExistingToken(),this._logoutButton.destroy(),this._loginStatus.innerHTML="",this._showLogin()):(a.forEach(c,f.hitch(this,function(b){a.forEach(b.listOptions,f.hitch(this,function(a){a.caption=
this._decodeUnicode(a.caption)}))})),r.hide(this._loadingParams),this._activeForm=(new G({options:this.options,parameters:c,ws:b,restManager:this.FMERestManager,geometry:this._activeGeometry})).placeAt(this._formContent,"last"),this.options.settings.fme.server.adminMode?(u.byId("fmeportal-details")&&u.byId("fmeportal-details").destroy(),this.FMERestManager.getWorkspaceInfo(b.repo,b.id).then(f.hitch(this,function(a){this._detailsButton=(new w({id:"fmeportal-details",label:this.nls.WorkspaceInfo.ButtonLabel,
style:"margin:5px;",onClick:f.hitch(this,function(){this._workspaceInfo=new F(a);n.publish("FMEPortal/alert",this.nls.WorkspaceInfo.Label+" "+b.id,this._workspaceInfo)})})).placeAt(this._formContent,"last").startup();this._wsSelect.set("disabled",!1);this._activeForm.addServiceSelect(a)}))):this._wsSelect.set("disabled",!1))}))},_decodeUnicode:function(b){var c=b.match(/<u\s*\w.*?>/g);a.forEach(c,f.hitch(this,function(a){var c;c=a.replace("\x3c","\\").replace("\x3e","");c=decodeURIComponent(JSON.parse('"'+
c+'"'));b=b.replaceAll(a,c)}));return b},destroy:function(){this.inherited(arguments)}})});